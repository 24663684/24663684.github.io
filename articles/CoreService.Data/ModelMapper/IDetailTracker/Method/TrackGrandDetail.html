<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>IDetailTracker.TrackGrandDetail&lt;TDetailModel, TGrandDetailModel&gt;(Expression&lt;Func&lt;TModel, object&gt;&gt; propertyExpr, Expression&lt;Func&lt;TDetailModel, object&gt;&gt; detailPropertyExpr, IModelEntry&lt;TGrandDetailModel&gt; grandModelEntry) Method </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="IDetailTracker.TrackGrandDetail&lt;TDetailModel, TGrandDetailModel&gt;(Expression&lt;Func&lt;TModel, object&gt;&gt; propertyExpr, Expression&lt;Func&lt;TDetailModel, object&gt;&gt; detailPropertyExpr, IModelEntry&lt;TGrandDetailModel&gt; grandModelEntry) Method ">
    <meta name="generator" content="docfx 2.40.2.0">
    
    <link rel="shortcut icon" href="../../../../../images/logo-appeon.png ">
    <link rel="stylesheet" href="../../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../../index.html">
        	<img id="logo" src="../../../../../images/logo-appeon.png" height="20" width="164.45" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="idetailtrackertrackgranddetailtdetailmodel-tgranddetailmodelexpressionfunctmodel-object-propertyexpr-expressionfunctdetailmodel-object-detailpropertyexpr-imodelentrytgranddetailmodel-grandmodelentry-method"><strong>IDetailTracker.TrackGrandDetail&lt;TDetailModel, TGrandDetailModel&gt;(Expression&lt;Func&lt;TModel, object&gt;&gt; propertyExpr, Expression&lt;Func&lt;TDetailModel, object&gt;&gt; detailPropertyExpr, IModelEntry&lt;TGrandDetailModel&gt; grandModelEntry) Method</strong></h2>

<p><strong>.NET Standard 2.x |</strong>  <a href="javascript:void(0)" class="dropdown">Current version (0.5.0-alpha) <img src="../../../../../images/dropdown.png"></a></p>
<div class="otherversions" value="versdiv">
<p><a href="javascript:void(0)">0.5.0-alpha</a></p>
<p><a href="javascript:void(0)">0.5.1-alpha(current)</a></p>
</div>
<p>When working with three-level models which have master-detail-granddetail relationship by applying the <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute in a property of the master model and a property of the detail model，追踪一个对granddetail model映射的数据库表的insert, update or delete操作,由数据的状态决定操作的类型，把即将被用来操纵数据库表的数据缓存于TGrandDetailModel中。</p>
<p>当IModelMapper.SaveChanges被调用时，一条SQL INSERT, UPDATE or DELETE statement 将用缓存在TGrandDetailModel中的数据以及被定义在TGrandDetailModel中的映射信息来产生并执行。</p>
<p>Tracks an insert, update or delete operation on the table which the granddetail model is mapped to when working with the master-detail-granddetail models where the <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute is applied in a property of the master model and a property of the detail model. The data state determines which type of operation to be performed. The data to be manipulated is cached in  TGrandDetailModel.</p>
<p>When IModelMapper.SaveChanges is called, a SQL statement (INSERT, UPDATE, or DELETE) will be generated using the data cached in TGrandDetailModel and the mapping information defined in TGrandDetailModel, and then the SQL statement will be executed.</p>
<p><strong>Namespace:</strong> Appeon.CoreService.Data</p>
<p><strong>Assembly:</strong> Appeon.CoreService.Data.dll</p>
<h3 id="syntax"><strong>Syntax</strong></h3>
<pre><code class="lang-c#">  	IDetailTracker&lt;TModel&gt; TrackGrandDetail&lt;TDetailModel, TGrandDetailModel&gt;(Expression&lt;Func&lt;TModel, object&gt;&gt; propertyExpr, IModelEntry&lt;TDetailModel&gt; modelEntry, Expression&lt;Func&lt;TDetailModel, object&gt;&gt; detailPropertyExpr, IModelEntry&lt;TGrandDetailModel&gt; grandModelEntry);

</code></pre>
<p><strong>Type Parameters</strong></p>
<p><code>TDetailModel</code></p>
<p>The type of a model class that conforms to the Appeon standard.</p>
<p>It is the type of the specified property in the detail model.</p>
<p><code>TGrandDetailModel</code></p>
<p>The type of a model class that conforms to the Appeon standard.</p>
<p>It is the type of the specified property in the granddetail model.</p>
<p><strong>Parameters</strong></p>
<p><code>propertyExpr</code> System.Linq.Expressions.Expression&lt;Func&lt;TModel, object&gt;&gt;</p>
<p>主model的一个属性，其上实例化了ModelEmbeddedAttribute (ModelType属性是TDetailModel, 称为detail model)。</p>
<p>该属性的类型也是TDetailModel。</p>
<p>该属性由一个表达式指定。</p>
<p>A property of the master model where the <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute (the ModelType property is TDetailModel and is called detail model) is applied.</p>
<p>The type of this property is TDetailModel.</p>
<p>This property is specified by an expression.</p>
<p><code>detailPropertyExpr</code> System.Linq.Expressions.Expression&lt;Func&lt;TDetailModel, object&gt;&gt;</p>
<p>detail model的一个属性，其上实例化了ModelEmbeddedAttribute (ModelType属性是TGrandDetailModel, 称为granddetail model)。</p>
<p>该属性的类型是TGrandDetailModel。</p>
<p>该属性由一个表达式指定。</p>
<p>A property of the detail model where the <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute (the ModelType property is TGrandDetailModel and is called granddetail model) is applied.</p>
<p>The type of this property is TGrandDetailModel.</p>
<p>This property is specified by an expression.</p>
<p><code>grandModelEntry</code> <a href="../../IModelEntry/IModelEntry.html">Appeon.CoreService.Data.IModelEntry</a>&lt;TGrandDetailModel&gt;</p>
<p>需要跟踪的一个包装了数据和数据状态的IModelEntry对象.数据对应第二个属性表达式。</p>
<p>The IModelEntry object which packages the data and data state and which will be tracked. The data corresponds to the second property expression.</p>
<p><strong>Returns</strong></p>
<p>Appeon.CoreService.Data.IDetailTracker&lt;TModel&gt;</p>
<p>返回IDetailTracker&lt;TModel&gt;接口对象。</p>
<p>Returns the IDetailTracker&lt;TModel&gt; interface.</p>
<h3 id="remarks"><strong>Remarks</strong></h3>
<p>需要在TModel和TDetailModel 中定义ModelEmbedded attribute来表示TModel，TDetailModel和TGrandDetailModel的master-detail-granddetail relationship。</p>
<p>具体参考ModelEmbeddedAttribute中的相关说明。</p>
<p>The <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute must be applied in TModel and TDetailModel to create the master-detail-granddetail relationship between TModel, TDetailModel, and TGrandDetailModel. Refer to the <a href="../../ModelAttribute/Property/ModelEmbeddedAttribute/ModelEmbeddedAttribute.html">ModelEmbedded</a> attribute for more.</p>
<h4 id="one-to-one-to-one">One-to-one-to-one</h4>
<p>propertyExpr参数指定的属性的类型是TDetailModel (该属性可代表数据库表的一行数据)，detailPropertyExpr参数指定的属性类型是TGrandDetailModel (该属性可代表数据库表的一行数据), 因此IDetailTracker.TrackDetailAndGrandDetail 方法适用于一行主表对应一行明细表再对应一行GrandDetail表的数据库表关系。</p>
<p>The type of the property specified by propertyExpr parameter is TDetailModel (which represents one row in the detail database table). The type of the property specified by detailPropertyExpr parameter is TGrandDetailModel (which represents one row in the granddetail database table). Therefore, the IDetailTracker.TrackDetailAndGrandDetail method applies to one-to-one-to-one table relationship (one master table record to one detail table record to one granddetail table record).</p>
<h4 id="trackmaster">TrackMaster</h4>
<p>IModelMapper.TrackMaster方法会在中跟踪master model之后会返回IDetailTracker接口对象。之后可以使用IDetailTracker.TrackDetail和IDetailTracker.TrackGrandDetail方法跟踪detail model和granddetail model。</p>
<p>The IModelMapper.TrackMaster method will track the master model and return the IDetailTracker interface. Then the IDetailTracker.TrackDetail method IDetailTracker.TrackGrandDetail can be used to track the detail model and the granddetail model.</p>
<p>For more about the TrackMaster method, refer to IModelMapper.TrackMaster.</p>
<h3 id="examples"><strong>Examples</strong></h3>
<p>同步保存三层主从表数据，且主表与从表数据均为一条</p>
<p>The following code example demonstrates how to save the master table, the
detail table, and the grand-detail table synchronously; all of them have<br>
only one affected record.</p>
<pre><code class="lang-C#">using Appeon.CoreService.Data;
using Appeon.Examples.Models.School;
using System;

namespace Appeon.Examples.IDetailTracker
{
    public class TrackGrandDetailExample
    {
        private readonly SchoolContext _context;

        public TrackGrandDetailExample(SchoolContext dataContext)
        {
            // Sets the data context.
            _context = dataContext;
        }

        public void Example(IModelEntry&lt;DepartmentInfo&gt; depart,
                            IModelEntry&lt;CourseInfo&gt; course,
                            IModelEntry&lt;CourseStudentInfo&gt; courseStudent)
        {
            // Saves the master table, the detail table, and the grand-detail table; 
            // all of them have only one affected record.
            var modelmapper = _context.ModelMapper;

            var master = modelmapper.TrackMaster(depart)
                       .TrackDetail(m =&gt; m.Courses, course)
                       .TrackGrandDetail&lt;CourseInfo, CourseStudentInfo&gt;(
                            m =&gt; m.Courses,
                            d =&gt; d.Students,
                            courseStudent)
                       .MasterModel;

            var dbResult = modelmapper.SaveChanges();

            // Shows the saving result.
            Console.WriteLine(&quot;{0} records have been inserted into the database.&quot;,
                              dbResult.AffectedCount);

            /* This code example produces the following output:
            
            3 records have been inserted into the database.
            */
        }
    }
}
</code></pre>
<h4 id="related-exampes">Related Exampes</h4>
<p>Model Classes: <a href="../../../SourceCode/Examples/Models/School/Embedded/CourseInfo.html">CourseInfo</a> <a href="../../../SourceCode/Examples/Models/School/Embedded/CourseStudentInfo.html">CourseStudentInfo</a> <a href="../../../SourceCode/Examples/Models/School/Embedded/DepartmentInfo.html">DepartmentInfo</a> <br>Controller Class: <a href="../../../SourceCode/Examples/Controllers/IDetailTrack/TrackGrandDetailExampleController.html">TrackGrandDetailExampleController</a> <br></p>
<h3 id="applies-to"><strong>Applies to</strong></h3>
<p>.NET Standard</p>
<p>2.x</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>Appeon</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../../styles/main.js"></script>
  </body>
</html>
