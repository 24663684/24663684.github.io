<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>IDataStore.ImportJson(string json, DwBuffer dwbuffer, int startRow, int endRow, int startColumn, int endColumn) Method </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="IDataStore.ImportJson(string json, DwBuffer dwbuffer, int startRow, int endRow, int startColumn, int endColumn) Method ">
    <meta name="generator" content="docfx 2.37.0.0">
    
    <link rel="shortcut icon" href="../../../../../../images/128x128.PNG">
    <link rel="stylesheet" href="../../../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../../../index.html">
        	<img id="logo" src="../../../../../../images/logo-appeon.png" height="20" width="164.45" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="idatastoreimportjsonstring-json-dwbuffer-dwbuffer-int-startrow-int-endrow-int-startcolumn-int-endcolumn-method"><strong>IDataStore.ImportJson(string json, DwBuffer dwbuffer, int startRow, int endRow, int startColumn, int endColumn) Method</strong></h2>

<p><strong>.NET Standard 2.x |</strong>  <a href="javascript:void(0)" class="dropdown">Current Version (0.5.0-alpha) <img src="../../../../../../images/dropdown.png"></a></p>
<div class="otherversions" value="versdiv">
<p><a href="javascript:void(0)">0.5.0-alpha</a></p>
<p><a href="javascript:void(0)">0.5.1-alpha (current)</a></p>
</div>
<p>Inserts data from a JSON string into the specified buffer of DataStore. You can specify the starting and ending positions in the JSON array,  and you can specify the number of the first key value and the number of the last key value in the JSON object to be imported. Data that are out of this range will not be imported into the DataStore.</p>
<p><strong>Namespace:</strong> Appeon.Data.PowerBuilder</p>
<p><strong>Assembly:</strong> Appeon.Data.PowerBuilder.dll</p>
<h3 id="syntax"><strong>Syntax</strong></h3>
<pre><code class="lang-c#">   public int ImportJson(string json, DwBuffer dwbuffer, int startRow, int endRow, int startColumn, int endColumn);
</code></pre>
<p><strong>Parameters</strong></p>
<p><code>json</code>	System.String</p>
<p>A string specifying the JSON data.</p>
<p>The JSON string must comply with the <a href="../../../../Glossary/DataFormat/JsonFormat/Simple.html">simple-format JSON</a> or <a href="../../../../Glossary/DataFormat/JsonFormat/Standard.html">standard-format JSON</a>.</p>
<p><code>dwbuffer</code>	<a href="../../DwBuffer/DwBuffer.html">Appeon.Data.PowerBuilder.DwBuffer</a></p>
<p>The specified buffer of the DataStore.</p>
<p>A value of the <code>DwBuffer</code> enumerated datatype identifying the <code>DataWindow buffer</code> into which you want to import the data.</p>
<p>For <a href="../../../../Glossary/DataFormat/JsonFormat/Simple.html">simple-format JSON</a>: Imports the JSON data to the specified buffer.</p>
<p>For <a href="../../../../Glossary/DataFormat/JsonFormat/Standard.html">standard-format JSON</a>: Imports data from the specified buffer from the JSON string to the corresponding buffer.</p>
<p><code>startRow</code>	System.Int32</p>
<p>The zero-based number of the first detail object in the JSON array that you want to import. If it is negative, 0 is used.</p>
<p><code>endRow</code>	System.Int32</p>
<p>The zero-based number of the last detail object in the JSON array that you want to import. If it is negative, it indicates the rest of rows.</p>
<p><code>startColumn</code>	System.Int32</p>
<p>The zero-based number of the first key value in the JSON object that you want to import. If it is negative, 0 is used.</p>
<p><code>endColumn</code>	System.Int32</p>
<p>The zero-based number of the last key value in the JSON object that you want to import. If it is negative, it indicates the rest of columns.</p>
<p><strong>Returns</strong></p>
<p>System.Int32</p>
<p>Returns the number of rows that were imported if it succeeds.</p>
<h3 id="examples"><strong>Examples</strong></h3>
<p>The following code example demonstrates how to import the department data from between the starting row and the ending row and from between the starting column and the ending column in a JSON string to the specified buffer.</p>
<pre><code class="lang-C#">using Appeon.Data.PowerBuilder;
using System;
using System.IO;

namespace Appeon.ApiDoc.IDataStoreExamples
{
    public class ImportJsonExample
    {
        private SchoolContext _context;

        public ImportJsonExample(SchoolContext dataContext)
        {
            // Sets the data context
            _context = dataContext;
        }

        public void Example6()
        {
            // Instantiates the datastore with datawindow: d_department2.
            // d_department2 has no departmentID column
            var datastore = new DataStore(&quot;d_department2&quot;, _context);

            // Gets the JSON file. ImportJson8.json contains 4 records.
            string path = Path.Combine(AppContext.BaseDirectory,
                                @&quot;Jsons\IDatastore\ImportJson8.json&quot;);
            string json = File.ReadAllText(path);

            // Imports data from JSON to the DataStore primary buffer
            // from row 1 through the end.
            // Imports data starting from column 2 and imports only one column, 
            // so only column 2 is imported.
            datastore.ImportJson(json, DwBuffer.Primary, 0, 3, 1, 1);

            Console.WriteLine(&quot;Rowcount:{0}&quot;, datastore.RowCount);

            for (int row = 0, rowcount = datastore.RowCount; row &lt; rowcount; row++)
            {
                Console.WriteLine(&quot;Name:{0}; Budget:{1}&quot;,
                                  datastore.GetItem&lt;string&gt;(row, &quot;name&quot;),
                                  datastore.GetItem&lt;decimal&gt;(row, &quot;budget&quot;));
            }

            datastore.Reset();

            // Imports data from row 2 and 3 of the JSON string to the primary buffer
            // Imports data starting from column 2 and imports only one column. 
            // So column 1 will not be imported, and only column 2 is imported.
            datastore.ImportJson(json, DwBuffer.Primary, 1, 2, 1, 1);

            Console.WriteLine(&quot;Rowcount: {0}&quot;, datastore.RowCount);

            for (int row = 0, rowcount = datastore.RowCount; row &lt; rowcount; row++)
            {
                Console.WriteLine(&quot;Name: {0}; Budget: {1}&quot;,
                                  datastore.GetItem&lt;string&gt;(row, &quot;name&quot;),
                                  datastore.GetItem&lt;decimal&gt;(row, &quot;budget&quot;));
            }

            /*This code produces the following output:

            Rowcount: 4
            Name: Engineering; Budget: 0
            Name: English; Budget: 0
            Name: Economics; Budget: 0
            Name: Mathematics; Budget: 0
            Rowcount: 2
            Name: English; Budget: 0
            Name: Economics; Budget: 0
           */
        }
    }
}
</code></pre>
<h4 id="example-refer-to">Example Refer To</h4>
<p>JSON File: <a href="../../../../SourceCode/Examples/Jsons/IDatastore/ImportJson8.html">ImportJson8</a> <br></p>
<h3 id="applies-to"><strong>Applies to</strong></h3>
<p>.NET Standard</p>
<p>2.x</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>Appeon</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../../../styles/main.js"></script>
  </body>
</html>
